(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66d754ac"],{1854:function(t,a,e){"use strict";var s=e("3e92"),i=e.n(s);i.a},"2afb":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"movie-comment"},[e("p",{staticClass:"movie-comment-title"},[t._v("\n    "+t._s(t.title)+" 的短评 · · · · ·\n    "),e("small",{staticClass:"rating-count"},[t._v("(全部 "+t._s(t.ratingCount)+" 条)")])]),e("hr"),e("el-breadcrumb",{attrs:{separator:"/"}},[e("el-breadcrumb-item",[e("a",{on:{click:t.newRating}},[t._v("最新")])]),e("el-breadcrumb-item",{attrs:{"aria-current":"page"}},[e("a",{on:{click:t.hotRating}},[t._v("最热")])])],1),e("commentCard",{attrs:{ratingsProp:t.ratings}}),e("hr"),t.nextPage?e("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v("加载更多")]):t._e()],1)},i=[],n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",t._l(t.comments,function(a,s){return t.comments?e("div",{staticClass:"rating"},[e("hr"),e("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[e("div",{staticClass:"comment-head"},[e("a",[e("img",{staticClass:"image avatar",attrs:{src:a.useravatar}})]),e("router-link",{attrs:{to:"/people/"+a.username}},[e("span",{staticClass:"name"},[t._v(t._s(a.username))])]),2===a.cate?e("span",{staticClass:"cate"},[t._v("看过")]):t._e(),1===a.cate?e("span",{staticClass:"cate"},[t._v("在看")]):t._e(),0===a.cate?e("span",{staticClass:"cate"},[t._v("想看")]):t._e(),e("el-rate",{staticClass:"rating-score",attrs:{disabled:"","text-color":"#ff9900"},model:{value:a.score/2,callback:function(e){t.$set(a,"score / 2",e)},expression:"rating.score / 2"}}),e("span",{staticClass:"time rating-time"},[t._v(t._s(a.time))]),e("a",{staticClass:"report",on:{click:function(a){return t.ratingAction(s,"report")}}},[e("i",{staticClass:"material-icons"},[t._v("error_outline")])]),"like"===a.me2rating?e("a",{staticClass:"like like-status",on:{click:function(a){return t.ratingAction(s,"unlike")}}},[e("i",{staticClass:"material-icons"},[t._v("favorite")]),e("span",{staticClass:"like-count"},[t._v(t._s(a.likecount))])]):t._e(),"unlike"===a.me2rating?e("a",{staticClass:"like unlike-status",on:{click:function(a){return t.ratingAction(s,"like")}}},[e("i",{staticClass:"material-icons"},[t._v("favorite")]),e("span",{staticClass:"like-count"},[t._v(t._s(a.likecount))])]):t._e()],1),e("div",{staticStyle:{padding:"14px"}},[e("div",{staticClass:"bottom clearfix"},[e("p",[t._v("\n                   "+t._s(a.comment)+"\n          ")])])])])],1):t._e()}),0)},o=[],c={inheritAttrs:!1,props:["ratingsProp"],data:function(){return{comments:[]}},watch:{ratingsProp:function(t){this.comments=t}},methods:{ratingAction:function(t,a){var e=this,s="/rating/"+this.comments[t].id,i=new URLSearchParams;i.append("typename",a),this.$http.post(s,i).then(function(s){if(e.showMessage(s.data.message,"success"),"report"!==a){var i=e.comments[t];i.me2rating=a,"like"===a?(i.likecount=i.likecount+1,e.$set(e.comments,t,i)):"unlike"===a&&(i.likecount=i.likecount-1,e.$set(e.comments,t,i))}}).catch(function(t){e.showMessage(t.response.data.message,"error")})},showMessage:function(t,a){this.$message({showClose:!0,message:t,type:a})}}},r=c,l=(e("5202"),e("2877")),u=Object(l["a"])(r,n,o,!1,null,null,null),m=u.exports,g={components:{commentCard:m},props:["title","movieId"],data:function(){return{thisMovieId:this.movieId,score:3.5,ratings:[],ratingCount:0,ratingCate:"",nextPage:"",loading:!0}},watch:{movieId:function(t,a){this.thisMovieId=t,this.fetchRating("hot",1)}},mounted:function(){this.fetchRating("hot",1)},methods:{newRating:function(){this.ratings=[],this.fetchRating("new",1)},hotRating:function(){this.ratings=[],this.fetchRating("hot",1)},fetchRating:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(this.loading=!0,a?this.ratingCate=a:a=this.ratingCate,this.thisMovieId){if(e>0){var i="/movie/"+this.thisMovieId+"/rating/all";s=i}this.$http.get(s,{params:{sort:a,page:e}}).then(function(a){t.ratingCount=a.data.count,t.ratings=t.ratings.concat(a.data.items),t.nextPage=a.data.next,t.loading=!1}).catch(function(a){console.log("get ratings error."),t.loading=!1})}},showMessage:function(t,a){this.$message({showClose:!0,message:t,type:a})},loadMore:function(){this.fetchRating(url=this.nextPage)}}},h=g,d=(e("1854"),Object(l["a"])(h,s,i,!1,null,null,null));a["default"]=d.exports},"3e92":function(t,a,e){},5202:function(t,a,e){"use strict";var s=e("f597"),i=e.n(s);i.a},f597:function(t,a,e){}}]);
//# sourceMappingURL=chunk-66d754ac.27dc1253.js.map